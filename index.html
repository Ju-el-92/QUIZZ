<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8" />
    <title>Quizz VTC</title>
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;700&display=swap" rel="stylesheet">
    <style>
        /* Styles CSS */
        body {
            font-family: 'Montserrat', sans-serif;
            background: #f4f4f4;
            margin: 0;
            padding: 20px;
            color: #0C2C1C;
            display: flex;
            justify-content: center;
            align-items: flex-start;
            min-height: 100vh;
            box-sizing: border-box;
        }

        .container {
            max-width: 700px;
            width: 100%;
            margin: 20px auto;
            background: white;
            padding: 30px;
            border-radius: 16px;
            box-shadow: 0 0 10px rgba(0,0,0,0.1);
            text-align: center;
        }

        .hidden {
            display: none;
        }

        button {
            background-color: #2A9C64;
            color: white;
            border: none;
            padding: 12px 24px;
            font-size: 16px;
            border-radius: 8px;
            cursor: pointer;
            transition: background-color 0.3s ease, transform 0.2s ease;
            margin-top: 15px;
        }

        button:hover {
            background-color: #228753;
            transform: translateY(-2px);
        }

        button:active {
            transform: translateY(0);
        }

        .option {
            display: block;
            width: calc(100% - 24px);
            margin: 12px auto;
            padding: 15px;
            border: 2px solid #ddd;
            border-radius: 8px;
            cursor: pointer;
            background: #fafafa;
            text-align: left;
            font-size: 1.1em;
            color: #333;
            transition: background-color 0.3s ease, border-color 0.3s ease, transform 0.2s ease;
        }

        .option:hover {
            background-color: #2A9C64;
            border-color: #2A9C64;
            color: white;
            transform: translateY(-2px);
        }

        .option.correct {
            background-color: #2A9C64;
            border-color: #2A9C64;
            color: white;
        }

        .option.incorrect {
            background-color: #e74c3c;
            border-color: #e74c3c;
            color: white;
        }

        .feedback-block {
            margin-top: 25px;
            background: #e8f5e9;
            padding: 15px;
            border-left: 5px solid #2A9C64;
            border-radius: 8px;
            text-align: left;
            font-size: 1em;
            color: #0C2C1C;
        }

        .feedback-block p {
            margin: 0;
            line-height: 1.5;
        }

        .question-block {
            margin-bottom: 30px;
        }

        .question-title {
            font-size: 1.5em;
            color: #2A9C64;
            margin-bottom: 15px;
            font-weight: bold;
        }

        .question-text {
            font-size: 1.2em;
            margin-bottom: 25px;
            line-height: 1.6;
            color: #333;
        }

        .result {
            padding: 20px 0;
        }

        .result h2 {
            font-size: 2.5em;
            color: #2A9C64;
            margin-bottom: 20px;
        }

        .score {
            font-size: 2.2em;
            font-weight: bold;
            color: #0C2C1C;
            margin-bottom: 15px;
        }

        .score-message {
            font-size: 1.3em;
            color: #555;
            margin-bottom: 30px;
            line-height: 1.5;
        }

        .link-block {
            background: #f0f8f0;
            padding: 15px;
            border-radius: 8px;
            border: 1px solid #d6e9d6;
            margin-bottom: 25px;
        }

        .link-block p {
            margin: 0;
            font-size: 1em;
            color: #333;
        }

        a {
            color: #2A9C64;
            text-decoration: none;
            font-weight: bold;
            transition: color 0.3s ease;
        }

        a:hover {
                color: #1a7a4f;
            text-decoration: underline;
        }

        #start-screen {
            padding: 20px 0;
        }
        #start-screen h1 {
            font-size: 2.8em;
            margin-bottom: 20px;
            color: #2A9C64;
        }
        #start-screen p {
            font-size: 1.2em;
            line-height: 1.6;
            margin-bottom: 30px;
            color: #333;
        }

        @media (max-width: 600px) {
            .container {
                padding: 20px;
                margin: 10px;
            }
            .question-title {
                font-size: 1.3em;
            }
            .question-text {
                font-size: 1em;
            }
            .option {
                padding: 12px;
                font-size: 1em;
            }
            .feedback-block {
                font-size: 0.9em;
            }
            .result h2 {
                font-size: 2em;
            }
            .score {
                font-size: 1.8em;
            }
            .score-message {
                font-size: 1.1em;
            }
            #start-screen h1 {
                font-size: 2.2em;
            }
            #start-screen p {
                font-size: 1em;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- The start screen is visible initially -->
        <div id="start-screen">
            <h1>üéì Quizz VTC</h1>
            <p>Ce quizz s‚Äôappuie sur les contenus des <strong>formations officielles VTC</strong>, notamment les modules 
  <em>¬´ Relation client et attitudes professionnelles ¬ª</em> ainsi que 
  <em>¬´ R√©glementation sp√©cifique √† l‚Äôactivit√© VTC ¬ª</em>.
</p>
<p>
  üî∂ Il permet une mise √† jour rapide et concr√®te des connaissances cl√©s, utiles pour maintenir une qualit√© de service optimale.</p>
<p> üëâüèº Ce quiz contient <strong>20 questions</strong>.  
            Chaque bonne r√©ponse vous rapporte <strong>3 points</strong>. Score maximum : <strong>60 points</strong>.</p>
            <button id="start-button">D√©marrer le Quizz</button>
        </div>

        <!-- This div will be the target for all dynamic content generated by JavaScript -->
        <div id="quiz-container">
            <!-- Quiz content (questions, options, results) will be loaded here by JavaScript -->
        </div>
    </div>

    <script>
        const questions = [
            {
                q: "Quel habitacle les passagers appr√©cient-ils le plus ?",
                options: [
                    "Un v√©hicule parfaitement propre, sans aucune odeur.",
                    "Une voiture parfum√©e avec beaucoup de d√©coration.",
                    "Une voiture personnelle avec objets visibles du chauffeur."
                ],
                answer: 0,
                feedback: "Les passagers appr√©cient g√©n√©ralement plus un espace neutre, impeccable et sans odeur marqu√©e."
            },
            {
                q: "√Ä quelle fr√©quence v√©rifier la propret√© du v√©hicule ?",
                options: [
                    "Quotidiennement avant le d√©but des courses.",
                    "Seulement quand le client se plaint.",
                    "Une fois par mois."
                ],
                answer: 0,
                feedback: "Une v√©rification quotidienne contribue √† une bonne premi√®re impression."
            },
            {
                q: "Quelle approche adopter concernant la conversation avec les passagers ?",
                options: [
                    "Parler uniquement si le passager engage la conversation.",
                    "Toujours parler pour √©viter le silence.",
                    "Ne jamais parler pendant le trajet."
                ],
                answer: 0,
                feedback: "Beaucoup de passagers pr√©f√®rent initier eux-m√™mes l‚Äô√©change."
            },
            {
                q: "Quel comportement est per√ßu comme professionnel ?",
                options: [
                    "Maintenir un ton respectueux et calme.",
                    "Donner syst√©matiquement son avis personnel.",
                    "Imposer une ambiance festive."
                ],
                answer: 0,
                feedback: "Un ton neutre et calme rassure le passager."
            },
            {
                q: "Que faire en cas de retard impr√©vu ?",
                options: [
                    "Pr√©venir imm√©diatement via l'application ou message.",
                    "Ne rien dire pour ne pas inqui√©ter.",
                    "Attendre d‚Äô√™tre arriv√© pour s‚Äôexcuser."
                ],
                answer: 0,
                feedback: "Pr√©venir du retard peut renforcer la qualit√© per√ßue du service."
            },
            {
                q: "Comment r√©agir si le passager est en retard ?",
                options: [
                    "Patienter quelques minutes avant d‚Äôappeler.",
                    "Klaxonner imm√©diatement.",
                    "Quitter les lieux apr√®s 1 minute."
                ],
                answer: 0,
                feedback: "La discr√©tion et la patience sont valoris√©es."
            },
            {
                q: "Quand proposer de l‚Äôaide avec les bagages ?",
                options: [
                    "Observer la situation et proposer si besoin.",
                    "Ne jamais proposer son aide.",
                    "Imposer directement son aide sans demander."
                ],
                answer: 0,
                feedback: "Une aide discr√®te et opportune est la mieux per√ßue."
            },
            {
                q: "Quelle petite attention est particuli√®rement appr√©ci√©e ?",
                options: [
                    "Rappeler au passager de v√©rifier ses effets personnels.",
                    "Offrir syst√©matiquement des brochures touristiques.",
                    "Parler politique avec le passager."
                ],
                answer: 0,
                feedback: "Rappeler au passager ses effets personnels montre attention et professionnalisme."
            },
            {
                q: "Quel style de conduite les passagers pr√©f√®rent-ils ?",
                options: [
                    "Fluide et strictement respectueux du code.",
                    "Rapide pour gagner du temps.",
                    "Dynamique avec d√©passements fr√©quents."
                ],
                answer: 0,
                feedback: "Une conduite fluide et rassurante est prioritaire."
            },
            {
                q: "Quelle est l‚Äôattitude recommand√©e concernant les appels t√©l√©phoniques ?",
                options: [
                    "√âviter les appels durant la course.",
                    "T√©l√©phoner r√©guli√®rement pendant la course en utilisant le kit mains-libres.",
                    "Expliquer au passager l‚Äôimportance de l‚Äôappel."
                ],
                answer: 0,
                feedback: "Ne pas passer d'appels contribue √† une atmosph√®re calme et professionnelle."
            },
            {
                q: "Quelle gestion de la musique privil√©gier ?",
                options: [
                    "Demander au passager s‚Äôil souhaite √©couter quelque chose.",
                    "Imposer ses propres go√ªts musicaux.",
                    "Laisser une musique forte pour dynamiser le trajet."
                ],
                answer: 0,
                feedback: "Une proposition personnalis√©e montre votre souci du confort passager."
            },
            {
                q: "Comment g√©rer la temp√©rature du v√©hicule ?",
                options: [
                    "Demander l‚Äôavis du passager sur la temp√©rature.",
                    "Garder syst√©matiquement la climatisation forte.",
                    "Ouvrir les fen√™tres par d√©faut."
                ],
                answer: 0,
                feedback: "Un ajustement selon les pr√©f√©rences passager est appr√©ci√©."
            },
            {
                q: "Quelle tenue vestimentaire privil√©gier ?",
                options: [
                    "Une tenue sobre, propre et adapt√©e √† la saison.",
                    "Une tenue sportive d√©contract√©e.",
                    "Une tenue √©l√©gante de soir√©e."
                ],
                answer: 0,
                feedback: "Une tenue simple, propre et professionnelle est valoris√©e par les passagers."
            },
            {
                q: "Quelle attitude adopter face √† un passager m√©content ?",
                options: [
                    "√âcouter calmement et proposer une solution adapt√©e.",
                    "Ignorer compl√®tement ses remarques.",
                    "R√©pondre agressivement pour montrer son d√©saccord."
                ],
                answer: 0,
                feedback: "Une √©coute active et la proposition d'une solution calme le passager et am√©liore l'exp√©rience."
            },
            {
                q: "En cas d'objet oubli√© par un passager, quelle est la bonne pratique √† suivre ?",
                options: [
                    "Contacter imm√©diatement le passager ou la plateforme concern√©e.",
                    "Conserver l‚Äôobjet sans le signaler.",
                    "Jeter l‚Äôobjet apr√®s 24 heures."
                ],
                answer: 0,
                feedback: "La r√©activit√© et l'honn√™tet√© renforcent votre professionnalisme."
            },
            {
                q: "Comment accueillir id√©alement un passager √† bord ?",
                options: [
                    "Saluer poliment et v√©rifier l‚Äôidentit√© du passager.",
                    "Ne rien dire pour √©viter tout malentendu.",
                    "Laisser le passager monter sans interaction."
                ],
                answer: 0,
                feedback: "Une salutation polie et une v√©rification discr√®te assure un accueil rassurant et professionnel."
            },
            {
                q: "Quelle attitude adopter en cas de d√©saccord sur le trajet choisi par le passager ?",
                options: [
                    "Expliquer calmement les alternatives tout en respectant sa d√©cision finale.",
                    "Imposer votre itin√©raire syst√©matiquement.",
                    "Refuser le trajet imm√©diatement."
                ],
                answer: 0,
                feedback: "Une attitude conciliante et informative valorise votre professionnalisme."
            },
            {
                q: "Quelle est la meilleure pratique en cas de demande sp√©cifique d‚Äôun passager (musique, itin√©raire pr√©cis, arr√™t rapide) ?",
                options: [
                    "S‚Äôadapter √† la demande si elle est raisonnable et possible.",
                    "Ignorer les demandes sp√©cifiques.",
                    "Faire syst√©matiquement payer plus cher."
                ],
                answer: 0,
                feedback: "La flexibilit√© face aux demandes raisonnables am√©liore consid√©rablement l'exp√©rience client."
            },
            {
                q: "Comment r√©agir si un passager utilise un langage ou un comportement inappropri√© ?",
                options: [
                    "Garder son calme et rappeler poliment les r√®gles de biens√©ance.",
                    "R√©pondre agressivement pour montrer son autorit√©.",
                    "Ignorer totalement le comportement."
                ],
                answer: 0,
                feedback: "Maintenir son calme tout en rappelant poliment les r√®gles contribue √† d√©samorcer la situation."
            },
            {
                q: "Quelle r√©action adopter en cas d‚Äôincident l√©ger pendant le trajet (petit accident mat√©riel sans gravit√©) ?",
                options: [
                    "Informer calmement le passager et prendre les dispositions n√©cessaires pour assurer sa s√©curit√©.",
                    "Ignorer l‚Äôincident pour √©viter d‚Äôinqui√©ter le passager.",
                    "Exiger que le passager descende imm√©diatement."
                ],
                answer: 0,
                feedback: "Une gestion calme et s√©curisante rassure le passager et confirme votre professionnalisme."
            }
        ];

        let currentQuestionIndex = 0;
        let score = 0;
        let userAnswers = [];

        const startScreen = document.getElementById("start-screen");
        const quizContainer = document.getElementById("quiz-container");

        // Fonction utilitaire pour m√©langer un tableau (algorithme de Fisher-Yates)
        function shuffleArray(array) {
            for (let i = array.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [array[i], array[j]] = [array[j], array[i]]; // √âchange les √©l√©ments
            }
            return array;
        }

        function startQuiz() {
            currentQuestionIndex = 0;
            score = 0;
            userAnswers = [];
            startScreen.classList.add("hidden");
            quizContainer.classList.remove("hidden");
            showQuestion();
        }

        function showQuestion() {
            const current = questions[currentQuestionIndex];

            // Pr√©pare les options avec leur texte et un indicateur si c'est la bonne r√©ponse
            const optionsWithCorrectness = current.options.map((text, i) => ({
                text: text,
                isCorrectOption: (i === current.answer) // Indique si cette option est la bonne r√©ponse
            }));

            // M√©lange les options
            const shuffledOptions = shuffleArray(optionsWithCorrectness);

            quizContainer.innerHTML = `
                <div class="question-block">
                    <div class="question-title">Question ${currentQuestionIndex + 1}/${questions.length}</div>
                    <div class="question-text">${current.q}</div>
                    ${shuffledOptions.map((opt, i) => `
                        <button class="option" data-is-correct-option="${opt.isCorrectOption}" data-selected-text="${opt.text}">
                            ${opt.text}
                        </button>
                    `).join("")}
                </div>
                <div class="feedback-block hidden" id="current-feedback-block">
                    <p><strong id="feedback-text"></strong></p>
                    <button id="next-question-btn">Suivant</button>
                </div>
            `;

            // Attacher les √©couteurs d'√©v√©nements APR√àS que les √©l√©ments soient cr√©√©s
            const optionsButtons = quizContainer.querySelectorAll(".option");
            optionsButtons.forEach(button => {
                button.addEventListener('click', function() {
                    selectAnswer(this); // Passer le bouton cliqu√©
                });
            });

            // G√©rer le bouton suivant s√©par√©ment
            document.getElementById("next-question-btn").addEventListener('click', nextQuestion);
        }

        function selectAnswer(clickedButton) {
            const current = questions[currentQuestionIndex];
            const isCorrect = clickedButton.dataset.isCorrectOption === 'true'; // V√©rifie la propri√©t√© m√©lang√©e

            if (isCorrect) score += 3;
            userAnswers.push({
                question: current.q,
                selected: clickedButton.dataset.selectedText, // Texte de l'option cliqu√©e
                correct: current.options[current.answer], // Texte de la bonne r√©ponse originale
                isCorrect: isCorrect,
                feedback: current.feedback
            });

            const optionsButtons = quizContainer.querySelectorAll(".option");
            optionsButtons.forEach(button => {
                // Supprimer tous les √©couteurs pour √©viter les clics multiples sur les options d'une m√™me question
                button.removeEventListener('click', arguments.callee); // Retire l'ancien √©couteur
                button.style.pointerEvents = 'none'; // D√©sactive le bouton visuellement

                if (button.dataset.isCorrectOption === 'true') { // V√©rifie si cette option est la bonne
                    button.classList.add("correct");
                } else if (button === clickedButton) { // Si c'est le bouton cliqu√© et qu'il est faux
                    button.classList.add("incorrect");
                }
            });

            // Afficher le feedback et le bouton "Suivant"
            const feedbackBlock = document.getElementById("current-feedback-block");
            document.getElementById("feedback-text").textContent = `üí° Feedback : ${current.feedback}`;
            feedbackBlock.classList.remove("hidden");
        }

        function nextQuestion() {
            currentQuestionIndex++;
            if (currentQuestionIndex < questions.length) {
                showQuestion();
            } else {
                showResults();
            }
        }

        function getScoreMessage(score) {
            if (score >= 54) return "üèÜ Excellent ! Vous ma√Ætrisez parfaitement les bonnes pratiques VTC.";
            if (score >= 48) return "ü•á Tr√®s bien ! Vous avez une bonne compr√©hension des standards professionnels.";
            if (score >= 42) return "ü•à Bien ! Quelques points √† revoir pour parfaire votre approche.";
            if (score >= 36) return "ü•â Correct, mais il serait b√©n√©fique de r√©viser certains aspects.";
            return "üìö Il est recommand√© de reprendre la formation pour mieux assimiler les bonnes pratiques.";
        }

        function showResults() {
            const message = getScoreMessage(score);
            quizContainer.innerHTML = `
                <div class="result">
                    <h2>üéâ R√©sultats</h2>
                    <p class="score">${score}/60</p>
                    <p class="score-message">${message}</p>
                    <div class="link-block">
                        <p>üëâ Consultez les annales officielles :<br>
                        <a href="https://www.artisanat.fr/nous-connaitre/vous-accompagner/examens-taxi-vtc-vmdtr" target="_blank">
                            Acc√©der aux annales
                        </a></p>
                    </div>
                    <button id="restart-quiz-btn">Recommencer</button>
                </div>
            `;

            document.getElementById("restart-quiz-btn").addEventListener('click', startQuiz);

            const now = new Date();
            const timestamp = now.toLocaleString('fr-FR', {
                year: 'numeric',
                month: '2-digit',
                day: '2-digit',
                hour: '2-digit',
                minute: '2-digit',
                second: '2-digit'
            });

            // Pr√©paration des donn√©es √† envoyer √† Google Apps Script
            const dataToSend = {
                timestamp: timestamp,
                score: score,
                message: message
            };

            userAnswers.forEach((answer, index) => {
                dataToSend[`Q${index + 1}_Correct`] = answer.isCorrect ? 'True' : 'False';
            });

            // *** C'EST L'URL DE VOTRE APPLICATION GOOGLE APPS SCRIPT ***
            const appsScriptUrl = "https://script.google.com/macros/s/AKfycbwjFZcMo7OYUfFAkyTOGTAogF4-1cNskQ14oRT8F_KLFlv7GAQxm0EQFYShez5PJnzexQ/exec"; 

            fetch(appsScriptUrl, {
                method: "POST",
                headers: {
                    // C'est le changement cl√© pour le format URL-encoded !
                    'Content-Type': 'application/x-www-form-urlencoded;charset=UTF-8', 
                },
                body: new URLSearchParams(dataToSend).toString(), // Convertit l'objet en cha√Æne URL-encoded
            })
            .then(response => response.text()) // Lire la r√©ponse comme du texte
            .then(text => {
                console.log('R√©ponse de Google Apps Script (texte):', text);
                try {
                    const data = JSON.parse(text);
                    if (data.status === "success") {
                        console.log("Les donn√©es ont √©t√© ajout√©es √† Google Sheet avec succ√®s !");
                    }
                } catch (e) {
                    console.warn('Apps Script n\'a pas retourn√© du JSON, ou erreur de parsing. Texte:', text, 'Erreur:', e);
                }
            })
            .catch(error => {
                console.error('Erreur lors de l\'envoi des donn√©es √† Google Sheet:', error);
            });
        }

        document.addEventListener("DOMContentLoaded", function() {
            const startButton = document.getElementById("start-button");
            startButton.addEventListener("click", startQuiz);
            quizContainer.classList.add("hidden");
        });
    </script>
</body>
</html>
